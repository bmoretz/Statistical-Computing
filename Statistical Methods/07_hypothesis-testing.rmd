---
title: ''
mainfont: Arial
fontsize: 12pt
documentclass: report
header-includes:
- \PassOptionsToPackage{table}{xcolor}
- \usepackage{caption}
- \usepackage{amssymb}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \usepackage[normalem]{ulem}
- \usepackage{makecell}
- \usepackage[table]{xcolor}
- \usepackage{fancyhdr}
- \usepackage{boldline}
- \usepackage{tipa}
   \definecolor{headergrey}{HTML}{545454}
   \definecolor{msdblue}{HTML}{1C93D1}
   \pagestyle{fancy}
   \setlength\headheight{30pt}
   \rhead{\color{headergrey}\today}
   \fancyhead[L]{\color{headergrey}Moretz, Brandon}
   \fancyhead[C]{\Large\bfseries\color{headergrey}Hypothesis Testing}
   \rfoot{\color{headergrey}\thepage}
   \lfoot{\color{headergrey}Chapter 7}
   \fancyfoot[C]{\rmfamily\color{headergrey}Statistical Methods}
geometry: left = 1cm, right = 1cm, top = 2cm, bottom = 3cm
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
    fig_caption: yes
    latex_engine: xelatex
editor_options: 
  chunk_output_type: console
---


```{r knitr_setup, include = FALSE}

# DO NOT ADD OR REVISE CODE HERE
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, dev = 'png')
options(knitr.table.format = "latex")

```

```{r report_setup, message = FALSE, warning = FALSE, include = FALSE}

library(data.table, quietly = TRUE, warn.conflicts = FALSE)

assignInNamespace("cedta.pkgEvalsUserCode", c(data.table:::cedta.pkgEvalsUserCode, "rtvs"), "data.table")

library(here, quietly = T, warn.conflicts = F)
library(ggplot2, quietly = T, warn.conflicts = F)
library(ggrepel, quietly = TRUE, warn.conflicts = FALSE)
library(ggthemes, quietly = TRUE, warn.conflicts = FALSE)
library(knitr, quietly = TRUE, warn.conflicts = FALSE)
library(kableExtra, quietly = TRUE, warn.conflicts = FALSE)
library(scales, quietly = TRUE, warn.conflicts = FALSE)
library(pander, quietly = TRUE, warn.conflicts = FALSE)
library(dplyr, quietly = TRUE, warn.conflicts = FALSE)
library(formattable, quietly = TRUE, warn.conflicts = FALSE)
library(grid, quietly = TRUE, warn.conflicts = FALSE)
library(gridExtra, quietly = TRUE, warn.conflicts = FALSE)
library(WRS, quietly = TRUE, warn.conflicts = FALSE)

options(tinytex.verbose = TRUE)
suppressMessages(library("tidyverse"))

pretty_kable <- function(data, title, dig = 2) {
  kable(data, caption = title, digits = dig) %>%
    kable_styling(bootstrap_options = c("striped", "hover")) %>%
      kableExtra::kable_styling(latex_options = "hold_position")
}

theme_set(theme_light())

# Theme Overrides
theme_update(axis.text.x = element_text(size = 10),
             axis.text.y = element_text(size = 10),
             plot.title = element_text(hjust = 0.5, size = 16, face = "bold", color = "darkgreen"),
             axis.title = element_text(face = "bold", size = 12, colour = "steelblue4"),
             plot.subtitle = element_text(face = "bold", size = 8, colour = "darkred"),
             legend.title = element_text(size = 12, color = "darkred", face = "bold"),
             legend.position = "right", legend.title.align=0.5,
             panel.border = element_rect(linetype = "solid", 
                                         colour = "lightgray"), 
             plot.margin = unit(c( 0.1, 0.1, 0.1, 0.1), "inches"))

data.dir <- "D:/Projects/Statistical-Computing/datasets/"

install.packages("WRS")
```

```{r pander_setup, include = FALSE}

knitr::opts_chunk$set(comment = NA)

panderOptions('table.alignment.default', function(df)
    ifelse(sapply(df, is.numeric), 'right', 'left'))
panderOptions('table.split.table', Inf)
panderOptions('big.mark', ",")
panderOptions('keep.trailing.zeros', TRUE)

```

#### Chapter 7

### 7.1

Given that $\bar{X} = 78, \sigma^2 =25, n = 10, \alpha = 0.05$ test $H_0 : \mu \ge 80$, assuming that observations are randomly sampled from a normal distribution.

```{r, echo = T}
xbar <- 78; var <- 25; n <- 10
alpha <- 0.05; h0 <- 80

# greater than = left tail test

crit <- qnorm(alpha)

Z <- sqrt(n) * (xbar - h0) / sqrt( var )

ifelse(Z < crit, "Reject the null", "Cannot reject null")
```

### 7.2

Repeat the previous exercise, but test $H_0 : \mu = 80$

```{r, echo = T}

# equals = two-tailed test

crit <- qnorm(alpha/2)

Z <- sqrt(n) * (xbar - h0) / sqrt( var )

ifelse(Z < crit || crit > Z, "Reject the null", "Cannot reject the null")

```

### 7.3

For the data in Exercise 1, compute a 0.95 confidence interval and verify that this interval is consistent with y our decision about whether to reject the null hypothesis $H_0 : \mu = 80$.

```{r, echo = T}

xbar + qnorm(c(alpha/2, 1 - alpha/2)) * sqrt( var / n )
      
```

_80_ is in the confidence interval, so fail to reject.

### 7.4

For exercise 1, determine the p-value.

```{r, echo = T}
pnorm(Z)
```

### 7.5

For exercise 2, determine the p-value.

```{r, echo = T}
2 * (1 - pnorm(Z, lower.tail = F))
```

### 7.6

Given that $\bar{X} = 120, \sigma = 5, n = 49, \alpha = 0.05$, test $H_0 : \mu \ge 130$, assuming that observations are randomly sampled from a normal distribution.

```{r, echo = T}
xbar <- 120; sigma <- 5; n <- 49
alpha <- 0.05; h0 <- 130

crit <- qnorm(alpha)

Z <- sqrt(n) * (xbar - h0) / sigma

ifelse( Z < crit, "Reject null hypothesis", "Cannot reject null")
```

### 7.7

Repeat the previous exercise but test $H_0 : \mu = 130$.

```{r, echo = T}
h0 <- 130

# two tailed test
crit <- qnorm(c(alpha/2, 1 - alpha/2))

ifelse(Z < crit[1] || Z > crit[2], "Reject null hypothesis", "Cannot Reject Null")
```

### 7.8

For the previous exercise, compute a 0.95 confidence interval and compare the result with your decision about whether to reject $H_0$.

```{r, echo = T}
xbar + qnorm(c(Lower = alpha/2, Upper = 1 - alpha/2)) * sigma/sqrt(n)
```

130 is not in the confidence region, reject null-hypothesis.

### 7.9

If $\bar{X} = 23$ and $\alpha = 0.025$, can you make a decision about whether to reject $H_0 : \mu \le 25$ without knowing $\sigma$?

_Yes, the hypothesis is consistent with the sample mean._

### 7.10

An electronics firm mass-produces a component for which there is a standard measure of quality. Based on testing vast numbers of these components, the company has found that the average quality is $\mu = 232, \sigma = 4$.

However, in recent years, the quality has not been checked, so management asks you to check their claim with the goal of being reasonable certain that an average quality of less than 232 can be ruled out. That is, assume that the quality is poor and in fact less than 232 with the goal of empirically establishing that this assumption is unlikely.

You get $\bar{X} = 240$ based on a sample of $n = 25$ components, and you want the probability of a Type I error to be less than 0.01.

State the null hypothesis and perform the appropriate test, assuming normality.

#### Hypothesis:

$H_0 : \mu \le 232$

$H_A : \mu \ge 232$

```{r, echo = T}
xbar <- 240; sigma <- 4; n <- 25
alpha <- 0.01; h0 <- 232

# less than = upper-tailed test

crit <- qnorm(1 - alpha)

Z <- sqrt(n) * ( xbar - h0 ) / sigma

ifelse(Z > crit, "Reject the null", "Cannot reject the null")
```

### 7.11

An antipollution device for cars is claimed to have an average effectiveness of exactly 546. Based on a test of 20 such devices, you find that $\bar{X} = 565$.

Assuming normality and that $\sigma = 40$, would you rule out the claim with a Type I error probability of 0.05?

```{r, echo = T}
xbar <- 565; sigma <- 40; n <- 20
alpha <- 0.05; h0 <- 546

# equality = two tailed

crit <- qnorm(c(alpha/2, 1 - alpha/2))

Z <- sqrt(n) * (xbar - h0) / sigma

ifelse(Z < crit[1] || Z > crit[2], "Reject the null", "Cannot reject the null")
```

### 7.12

Comment on the relative merits of using a 0.95 confidence interval for addressing the effectiveness of the antipollution device in the previous exercise rather than test the hypothesis: $H_0 : \mu = 232$

```{r, echo = T}
xbar + qnorm(c(alpha/2, 1 - alpha/2)) * sigma/sqrt(n)

2 * ( 1 - pnorm(Z) )
```

The hypothesised value doesn't fall within the confidence interval, however the formalized test gives us a degree of strength on which we can reject the null. Here our p-value is .03, so we reject with confidence.

### 7.13


### 7.14
### 7.15
### 7.16
### 7.17
### 7.18
### 7.19

### 7.20
### 7.21
### 7.22
### 7.23
### 7.24
### 7.25
### 7.26
### 7.27
### 7.28
### 7.29

### 7.30
### 7.31
### 7.32
### 7.33
### 7.34
### 7.35
### 7.36
### 7.37

